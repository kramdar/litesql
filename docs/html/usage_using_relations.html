<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LiteSQL: Using Relations</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="usage_using_relations">Using Relations </a></h1>A simple database with Person-class and friends-relation.<p>
<div class="fragment"><pre class="fragment">&lt;?xml version=<span class="stringliteral">"1.0"</span>?&gt;
&lt;!DOCTYPE database SYSTEM <span class="stringliteral">"http://litesql.sourceforge.net/litesql.dtd"</span>&gt;
&lt;database name=<span class="stringliteral">"TestDatabase"</span> <span class="keyword">namespace</span>=<span class="stringliteral">"test"</span>&gt;
    &lt;<span class="keywordtype">object</span> name=<span class="stringliteral">"Person"</span>&gt;
        &lt;field name=<span class="stringliteral">"name"</span> type=<span class="stringliteral">"string"</span>/&gt;
    &lt;/<span class="keywordtype">object</span>&gt;
    &lt;relation name=<span class="stringliteral">"FriendsRelation"</span>&gt;
        &lt;relate <span class="keywordtype">object</span>=<span class="stringliteral">"Person"</span> handle=<span class="stringliteral">"friends"</span>/&gt;
        &lt;relate <span class="keywordtype">object</span>=<span class="stringliteral">"Person"</span>/&gt;
    &lt;/relation&gt;
&lt;/database&gt;    
</pre></div><h2><a class="anchor" name="usage_relationclass">
Relation-class</a></h2>
Usually relations are accessed using a relation handle that is attached to a persistent object. Sometimes, it may be convenient to access relation using static methods of Relation-class.<p>
Methods:<ul>
<li>link : link objects</li><li>unlink : remove a link between objects</li><li>get&lt;type&gt; : get a DataSource&lt;type&gt; of objects</li><li>del : drop links using an expression</li><li>( getTYPEn : non-template versions for relations with duplicate types )</li></ul>
<h2><a class="anchor" name="usage_relationhandle">
RelationHandle-class</a></h2>
Relation handle is attached to persistent object and it provides convenient access to relation. It can be used to link, unlink or select objects related to relation handle's owner.<p>
RelationHandle-class' methods:<ul>
<li>link : link owner to another object</li><li>unlink : unlink owner from another object</li><li>del : drop links using an expression</li><li>get&lt;type&gt; : get a DataSource&lt;type&gt; of objects (generated for n-ary relations)</li><li>get : get a DataSource of known type (generated for 2-ended relations, only one type)</li><li>( getTYPEn : non-template versions for relations with three or more duplicate types )</li></ul>
<h2><a class="anchor" name="usage_relationhandle_examples">
RelationHandle-Examples</a></h2>
A linking example: <div class="fragment"><pre class="fragment">Person bill(db), bob(db);
bill.name = <span class="stringliteral">"Bill"</span>;
bill.update();

bob.name = <span class="stringliteral">"Bob"</span>;
bob.update();

<span class="comment">// both objects must be stored in database before they can be linked</span>

bill.friends().link(bob);

<span class="comment">// following statement would throw an exception because they are already friends</span>
<span class="comment">// (friends is bidirectional relation)</span>
bob.friends().link(bill);
</pre></div><p>
A fetching example: <div class="fragment"><pre class="fragment">Person bob = bill.friends().get(Person::Name == <span class="stringliteral">"Bob"</span>).one();

vector&lt;Person&gt; billsFriends = bill.friends().get().all();
</pre></div><p>
An unlinking example: <div class="fragment"><pre class="fragment"><span class="comment">// Bill and Bob are no longer friends</span>
bill.friends().unlink(bob);
</pre></div><h2><a class="anchor" name="usage_relation_examples">
Relation-Examples</a></h2>
Same examples as above converted to static methods of FriendsRelation.<p>
A linking example: <div class="fragment"><pre class="fragment">Person bill(db), bob(db);
bill.name = <span class="stringliteral">"Bill"</span>;
bill.update();

bob.name = <span class="stringliteral">"Bob"</span>;
bob.update();

<span class="comment">// both objects must be stored in database before they can be linked</span>

FriendsRelation::link(db, bill, bob);
</pre></div><p>
A fetching example: <div class="fragment"><pre class="fragment">Person bob = FriendsRelation::getPerson2(db, 
                                         Person::Name == <span class="stringliteral">"Bob"</span>,
                                         FriendsRelation::Person1==bill.id).one();

vector&lt;Person&gt; billsFriends = 
     FriendsRelation::getPerson2(db, Expr(), 
                                 FriendsRelation::Person1==bill.id).all();
</pre></div><p>
An unlinking example: <div class="fragment"><pre class="fragment"><span class="comment">// Bill and Bob are no longer friends</span>
Friendsrelation::unlink(bill, bob);
</pre></div> </div>
<hr />
<a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=113304&amp;type=2" width="125" height="37" border="0" alt="SourceForge.net Logo" /></a>

